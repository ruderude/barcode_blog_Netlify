# Webシステム構築におけるセキュリティについて【】


## セキュリティとは

インターネット上に存在する悪意と脅威。

その「サイバー攻撃」における防御対策のこと。

## 主なサイバー攻撃の方法

- SSH接続でユーザー権限やルート権限を奪取してサーバー乗っ取り（事実上、何でもできてしまう）
- Webシステムに対してのイタズラ（フォームなどからリクエストを通して攻撃してくる）
- 大量アクセス攻撃(Ddos攻撃)

## どんなことが起こる？

サーバーが乗っ取られれば、

- ファイルの書き換え（サイトページの書き換え）
- DBからデータ取得（情報流出）
- 全データ削除
- 転送バッチなどを仕掛けて放置

など、なんでもできてしまう。

Webシステムへのアタックでは、

- DBからデータ取得（SQLインジェクションでのDB操作全般）
- JavaScriptによる攻撃者の意図する挙動

など、これまた致命的なダメージになるものが存在している。

アクセス攻撃では、

- サーバー負荷による通常業務への支障

が考えられる。


## すでに世の中で対策されている事案

### XSS（クロスサイトスクリプティング）

スクリプトをそのまま出力できる場合、そのページにリンクタグやJavaScriptコードを混入できてしまう。

#### XSS対策

エスケープなどして出力物をサニタイズ（無害化）する。

※参考資料
[クロスサイトスクリプティング（XSS）とは？](https://www.shadan-kun.com/waf_websecurity/xss/)


### SQLインジェクション

SQLへの挿入部分に悪意のあるコードを入れ込み、Webシステムの外部からDB（データベース）を操作すること

#### SQLインジェクション対策

バリデーションで入力値を制限する。（長いSQLを許すほどできることが多くなる）
PHPであれば、PDOクラスのプリペアドステートメントなどを使いサニタイズする。

※参考資料
[SQLインジェクションの5つの対策と被害事例](https://www.nttpc.co.jp/column/security/sql_injection.html)



### CSRF（クロスサイトリクエストフォージュリ）

ユーザーが悪意のあるURLにアクセスしてしまった場合に、意図しないリクエストを特定のWebサービスに送られてしまうというもの。

#### CSRF対策

どこの誰からのアクセスなのか？など明確にすること。
または、怪しいアクセスはブロックすること。
CSRFトークンをフォームに設置（その瞬間にしか知り得ない暗号）することにより、安全なパラメータとしてリクエストを処理するなどがある。

※参考資料
[クロスサイトリクエストフォージェリ（CSRF）とは](https://medium-company.com/クロスサイトリクエストフォージェリ/)

### セッションハイジャック

何らかの手段でログイン情報を窃取し、本人に成り代わって通信を行うというサイバー攻撃。

#### セッションハイジャック対策

セッション管理を見直す。
セッションの有効期限を短めに設定する。
Cookieの情報をJavaScriptで抜けないようにする。
CSRF対策。

※参考資料
[セッションハイジャックとは？](https://cybersecurity-jp.com/security-measures/18583)

### クリックジャッキング

ボタンやリンクなどを透明で見えない状態にして、通常のWebページの上にかぶせてしまい、意図的にクリックを誘導するサイバー攻撃。

#### クリックジャッキング対策

▼ユーザー側
- FlashやJavaScriptを無効にする
- ブラウザやOSのアップデート

▼管理側
- X-FRAME-OPTIONSを導入する

※参考資料
[クリックジャッキングとは？](https://it-trend.jp/cyber_attack/article/442-0026)

### ディレクトリトラバーサル

Webサイトからファイル名を直接指定するようなWebアプリケーションに対して、ファイル名を不正に書き換え、本来閲覧することができないファイルにアクセスする攻撃。

#### ディレクトリトラバーサル対策

- 公開しているディレクトリ以外にアクセスされないようにする
- ディレクトリやファイルには適切な権限をつける

※参考資料
[ディレクトリトラバーサルとは](https://medium-company.com/ディレクトリトラバーサル/)

### OSコマンドインジェクション

外部からのリクエストパラメータに悪意のあるOSコマンドを入力して、不正にサーバーを操作するサイバー攻撃。

#### OSコマンドインジェクション対策

ヘボいプログラム書くな！

※セキュリティ全般に言えることは、「外部からのデータを一切信用するな」の一点に尽きる。
そこに配慮したプログラミングを。

※参考資料
[OSコマンドインジェクションの仕組みとその対策](https://www.shadan-kun.com/blog/measure/2873/)

### その他主要キーワード

- エスケープ
特定の文字や記号を特殊文字で無害な状態で画面に描画させること。

- サニタイズ
無害化すること。
エスケープはサニタイズの一種と言える。

- https SSL化
通信の時に平文でなく暗号化された文字列でやりとりする方式。

- バリデーション
ユーザーの入力や不審なリクエストパラメータなどに対し、ルールを設けてチェックすること。

- ハッシュ化
パスワードの保存など、漏洩すると致命的なデータなどは不可逆な文字列へ変換する。


## まとめ

セキュリティに絶対的なサムシングなどなく、要所要所で気を使ったWebシステムを構築するしかない、ということになります。

一度に全部覚えるのは大変なので、頭の片隅においておきましょう。

※徳丸本は読もう！

***

[前の記事:ITエンジニアロードマップの目次【個人開発のすゝめ 1】](https://barcode-blog.netlify.app/blog/uokvvyjq2a)

[次の記事:環境構築について【個人開発のすゝめ 2】](https://barcode-blog.netlify.app/blog/zjogf8j1y9)
